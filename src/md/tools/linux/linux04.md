# 四、常用命令

## 4.1 Linux 终端命令格式

一个命令行中可以输入多个命令，命令之间用分号分隔

Linux系统严格区分大小写

Linux 所有的目录和文件名都是大小写敏感的

终端命令格式：

```bash
command [-/--options] [parameter]
```

command：命令名，相应功能的英文单词或单词的缩写

[-options]：选项，可用来对命令进行控制，也可以省略（单字符选项用－，单词选项使用--）

parameter：传给命令的参数，可以是零个、一个或者多个

> []代表可选

**自动补全**

- 在敲出/**文件/目录/命令**的前几个字母之后，按下`tab`键
- 如果输入的没有歧义，系统会自动补全
- 如果还存在其他**文件/目录/命令**，再按一下`tab`键，系统会提示可能存在的命令
- 按**上/下**光标键可以在曾经使用过的命令之间来回切换
- 如果想要退出选择，并且不想执行当前选中的命令，可以按`ctrl+c`

重要热键
   Ctrl+C              中断前台执行程序
   Ctrl+D           离开当前shell
   上下方向键           翻出历史命令
   Tab：按一次         命令后自动补全命令，文件名后自动补全文件名
   Tab：按两次          出以输入开头的所有命令

## 4.2 目录操作基本命令

- 常用命令熟能生巧
- 学会常用命令，不常用可查询

| 命令          | 英文                    | 描述                       |
| ------------- | ----------------------- | -------------------------- |
| ls            | list                    | 查看当前文件夹下的内容     |
| tree [目录名] | tree                    | 以树状图列出文件目录结构   |
| cd            | change directory        | 更改当前工作目录           |
| pwd           | print working directory | 显示当前工作目录的绝对路径 |
| mkdir         | make directory          | 创建一个新目录             |
| rmdir         | remove directory        | 删除一个空目录             |

小技巧

- `ctrl + shift + =`**放大**终端窗口的字体显示
- `ctrl + -`**缩小**终端窗口的字体显示

**ls **

> 小知识：ls -al == ll (List Long)

**常用选项**

| 参数 | 含义                                                 |
| ---- | ---------------------------------------------------- |
| -a   | 显示指定目录下所有子目录与文件，包括隐藏文件         |
| -l   | 以列表方式显示文件的详细信息                         |
| -h   | 配合以人性化的方式显示文件大小                       |
| -t   | 按文件修改的时间排序显示                             |
| -s   | 显示每个文件的大小                                   |
| -S   | s（大写）按文件的大小排序                            |
| -F   | 显示文件类型描述符。*为可执行的普通文件，/为目录文件 |

**ls 通配符的使用**

| 通配符 | 含义                                 |
| ------ | ------------------------------------ |
| *      | 代表任意个数个字符                   |
| ?      | 代表任意一个字符，至少 1 个          |
| []     | 表示可以匹配字符组中的任一个         |
| [abc]  | 匹配 a、b、c 中的任意一个            |
| [a-f]  | 匹配从 a 到 f 范国内的的任意一个字符 |

### tree

| 选项 | 含义       |
| ---- | ---------- |
| -d   | 只显示目录 |

### cd

| 命令  | 含义                                     |
| ----- | ---------------------------------------- |
| cd    | 切换到当前用户的主目录（home/用户目录）  |
| cd ~  | 切换到当前用户的主目录（/home/用户目录） |
| cd /  | 切换到根目录                             |
| cd .  | 保持在当前目录不变                       |
| cd .. | 切换到上级目录                           |
| cd -  | 可以在最近两次工作目录之间来回切换       |

#### 相对路径和绝对路径

- 相对路径在输入路径时，最前面不是/或者～，表示相对**当前目录**所在的目录位置
- 绝对路径在输入路径时，最前面是/或者～，表示从**根目录/家目录**开始的具体目录位置

### mkdir

> 新建目录的名称不能与当前目录中已有的目录或文件同名

| 选项    | 含义                                     |
| ------- | ---------------------------------------- |
| -p      | 一次性建立多级目录，即以递归形式建立目录 |
| -m 权限 | 新建目录设置存取权限，权限777。          |

### rmdir

| 选项 | 含义             |
| ---- | ---------------- |
| -p   | 递归删除各级目录 |

## 4.3 文件操作基本命令

| 命令               | 英文        | 描述                                                         |
| ------------------ | ----------- | ------------------------------------------------------------ |
| touch              | touch       | 创建一个新的空白文件或更新现有文件的时间戳。                 |
| cat                | concatenate | 在终端显示一个或多个文件的内容。也可以用于连接文件并输出到新文件。 |
| cp 源文件 目标文件 | copy        | 从源位置复制一个或多个文件到指定目标位置。                   |
| rm                 | remove      | 永久删除一个或多个文件。                                     |
| mv 源文件 目标文件 | move        | 将文件从一个位置移动到另一个位置，也可以用于重命名文件。     |
| chmod              | change mode | 更改文件或目录的权限（读取、写入、执行）。                   |

### touch

- 创建文件或修改文件时间
  - 如果文件**不存在**，可以创建一个空白文件
  - 如果文件**已经存在**，可以修改文件的未次修改日期

### cat

> 小技巧：cat > 文件名 （新建文件）

- cat 命令可以用来**查看文件内容**、**创建文件**、**文件合并**、**追加文件内容**等功能
- cat 会一次显示所有的内容，适合**查看内容较少**的文本文件

| 选项 | 含义                                             |
| ---- | ------------------------------------------------ |
| -A   | 显示所有字符，包括换行符、制表符及其他非打印字符 |
| -s   | 连续的空行压缩为一个空行                         |
| -b   | 对非空输出行编号                                 |
| -n   | 对输出的所有行编号                               |

> Linux 中还有一个 nl 的命令和 cat-b 的效果等价

### cp

> cp 命令的功能是将给出的文件或目录复制到另一个文件或目录中，相当于 DOS 下的 copy 命令

| 选项 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| -i   | 覆盖文件前提示                                               |
| -r   | 若给出的源文件是目录文件，则 cp 将递归复制该目录下的所有子目录和文件，目标文件必须为一个目录名 |

### rm

> 使用 rm 命令要小心，因为文件删除后不能恢复
>
> rm -rf dirname #递归删除非空目录（慎用）

| 选项 | 含义                                             |
| ---- | ------------------------------------------------ |
| -i   | 询删除，避免误删                                 |
| -v   | 显示文件的删除进度                               |
| -f   | 强制删除，忽略不存在的文件，无需提示             |
| -r   | 递归地删除目录下的内容，删除文件夹时必须加此参数 |

### mv

> 命令可以用来移动文件或目录，也可以给文件或目录重命名

| 选项 | 含义           |
| ---- | -------------- |
| -i   | 覆盖文件前提示 |

### chmod

> Linux一个非常重要的命令，它的执行可以修改文件的权限和文件的属性。

命令格式如下：

`chmod [<文件使用者>+/-/=<权限类型>]文件名1文件名2`

| 文件使用者 | 英文   | 描述                     |
| ---------- | ------ | ------------------------ |
| u          | user   | 文件或目录所有者         |
| g          | group  | 文件所有者所在群组的用户 |
| o          | others | 其他用户                 |
| a          | all    | 所有用户                 |

| 操作符号 | 描述                           |
| -------- | ------------------------------ |
| +        | 增加权限                       |
| -        | 删除权限                       |
| =        | 赋予指定权限，并取消本来的权限 |

| 权限类型 | 权限                | 数字 | 对文件操作         | 对目录操作                 |
| -------- | ------------------- | ---- | ------------------ | -------------------------- |
| r        | 只读（read）权限    | 4    | 可以读取文件的内容 | 可以列出目录中的文件       |
| w        | 写（write）权限     | 2    | 可以修改、删除文件 | 可以在目录中创建、删除文件 |
| x        | 执行（execute）权限 | 1    | 可以执行文件       | 可以使用cd命令进入此目录   |

其他：

| 命令                | 英文         | 描述               |
| ------------------- | ------------ | ------------------ |
| chown 用户名 文件名 | change own   | 更改文件所有者     |
| chgrp 用户组 文件名 | change group | 更改所有者的所在组 |

## 4.4 文件处理命令

| 命令    | 英文       | 描述                                               |
| ------- | ---------- | -------------------------------------------------- |
| echo    | echo       | 打印一行文本或变量的值                             |
| grep    | grep       | 在文件中搜索匹配的字符串                           |
| head    | head       | 查看文件的前几行                                   |
| tail    | tail       | 查看文件的后几行                                   |
| wc      | word count | 统计文件中的行数、单词数和字符数                   |
| sort    | sort       | 对文件进行排序                                     |
| find    | find       | 在指定目录下查找文件或目录                         |
| which   | which      | 查找并显示给定命令的路径                           |
| whereis | where is   | 显示指定命令的二进制文件、源代码文件和帮助文件路径 |
| locate  | locate     | 通过文件名快速查找文件，使用内部数据库提高查找速度 |

### echo

echo 文字内容

- `echo`会在终端中显示参数指定的文字，通常会和**重定向**可联合使用

**重定向>和>>**

- Linux 允许将命令执行结果**重定向**到一个文件
- 将本应显示在**终端上的内容** **输出/追加**到**指定文件中**

其中

- `>` 表示输出，会覆盖文件原有的内容
- `>>`表示追加，会将内容追加到已有文件的未尾

**管道 l**

- Linux 允许将一个命令的输出可以通过管道做为另一个命令的输入
- 可以理解现实生活中的管子，管子的一头塞东西进去，另一头取出来，这里的左右分为两端，左端塞东西（写），右端取东西（读）

常用的管道命令有：

- `more`：分屏显示内容
- `grep`：在命令执行结果的基础上查询指定的文本

### grep

- Linux 系统中`grep`命令是一种强大的文本搜索工具
- grep 允许对文本文件进行**模式**查找，所谓模式查找，又被称为正则表达式

| 选项 | 含义                                     |
| ---- | ---------------------------------------- |
| -n   | 显示匹配行及行号                         |
| -v   | 显示不包含匹配文本的所有行（相当于求反） |
| -i   | 忽略大小写                               |

- 常用的两种模式查找

| 参数 | 含义                     |
| ---- | ------------------------ |
| ^a   | 行首，搜寻以 a 开头的行  |
| ke$  | 行尾，搜导以 ke 结束的行 |

### head/tail

> 查看文件的开头/结尾部分内容，默认10行

| 选项           | 含义                                          |
| -------------- | --------------------------------------------- |
| -n             | 想显示的行号                                  |
| -f（tail独占） | 实时监控文件变化，一般用于监控系统log日志文件 |

### wc

| 选项 | 含义       |
| ---- | ---------- |
| -l   | 显示行数   |
| -w   | 显示单词数 |
| -m   | 显示字符数 |

### sort

> 对文件内容或查询结果排序并输出，默认升序排序

| 选项   | 含义                           |
| ------ | ------------------------------ |
| -u     | 去重复行                       |
| -r     | 降序排序                       |
| -t，-k | -t 设定间隔符，-k 指定列数排序 |

### find

> 查找文件或目录，默认在本目录下，-name指定字符串查找文件或目录
>
> 小知识：
>
> **locate** 是find -name的另一种写法但是要比find命令快得多

| 命令                     | 作用                                         |
| ------------------------ | -------------------------------------------- |
| find [路径] -name “*.py” | 直找指定路径下扩展名是.py 的文件，包括子目录 |

- 如果省略路径，表示在当前文件夹下查找
- 之前学习的通配符，在使用`find`命令时同时可用

### which/whereis

| 命令    | 描述                                   | 对比         |
| ------- | -------------------------------------- | ------------ |
| which   | 查询命令的位置（绝对路径）             | 无           |
| whereis | 查询命令的位置以及包含文件名的所有文件 | 说明文档位置 |

### locate

>  查询新建文件，必须使用updatedb，使用locate去查找自己想要的东西，速度比find快
>
>  updatedb：更新locate查找信息的系统数据库的命令。

## 4.5 压缩备份基本命令

**打包**

- 打包压缩是日常工作中备份文件的一种方式
- 在不同操作系统中，常用的打包压缩方式是不同的
  - `Windos`常用`rar`
  - `Mac`常用`zip`
  - `Linux`常用`tar.gz`

**打包/解包**

- tar 是 Linux 中最常用的备份工具，此命令可以把一系列文件打包到一个大文件中，也可以把一个打包的大文件恢复成一系列文件

| 命令            | 英文           | 描述                                             |
| --------------- | -------------- | ------------------------------------------------ |
| tar             | tape archive   | 用于创建、查看和提取tar存档文件                  |
| zip             | zip            | 用于将文件压缩成zip格式的归档文件                |
| unzip           | unzip          | 用于解压缩zip格式的归档文件                      |
| gzip            | GNU zip        | 用于压缩文件并生成.gz格式的压缩文件              |
| bzip2           | bzip2          | 用于压缩文件并生成.bz2格式的压缩文件             |
| bunzip2         | bzip2          | 用于解压缩.bz2格式的压缩文件                     |
| zcat            | gzip catenate  | 用于查看.gz格式的压缩文件的内容                  |
| bzcat           | bzip2 catenate | 用于查看.bz2格式的压缩文件的内容                 |
| tar.gz（后缀）  | tar and gzip   | 用于将多个文件或目录压缩成.tar.gz格式的压缩文件  |
| tar.bz2（后缀） | tar and bzip2  | 用于将多个文件或目录压缩成.tar.bz2格式的压缩文件 |

### tar

> 注意：tar本身不具有压缩功能
>
> 打包是将文件或目录打成一个包（大文件夹），tar包文件的大小等于这些文件和目录的大小总和
>
> 注意：`f`选项必须放在最后，其他选项顺序可以随意

| 选项        | 含义                               |
| ----------- | ---------------------------------- |
| -c          | 创建一个新的归档文件               |
| -x          | 从归档文件中提取文件               |
| -f          | 指定要操作的归档文件               |
| -v          | 显示归档过程中处理的文件列表       |
| -t          | 列出归档文件中包含的文件列表       |
| -z          | 对归档文件进行 gzip 压缩           |
| -j          | 对归档文件进行 bzip2 压缩          |
| -r          | 向归档文件中添加文件               |
| --delete    | 从归档文件中删除文件               |
| --add-file  | 向归档文件中添加单个文件           |
| --wildcards | 使用通配符向归档文件中添加多个文件 |

| 常用选项         | 含义                                               |
| ---------------- | -------------------------------------------------- |
| -cf （打包）     | 打包成后缀为.tar的新文件                           |
| -tf              | 查看filename.tar打包文件里的内容                   |
| -xf （解包）     | 抽取filename.tar打包文件里的内容，原文件不会消失。 |
| -czvf            | 将文件打包并用gzip压缩                             |
| -cjvf            | 将文件打包并用bzip2压缩                            |
| -xzvf            | 将tar.gz文件解包并解缩                             |
| -xjvf            | 将tar.bz2文件解包并解缩                            |
| -xzvf 包 -C 路径 | 将tar.gz文件解包并解缩到指定目录                   |

### zip/unzip

> 压缩或解压缩文件、目录

优点：

- 兼容不同的操作系统，比如Linux，Windows及MacOS
- 可以用zip格式压缩那些需要共享给windows用户的文件

缺点：

- 压缩率不是很高

| 选项 | 含义             |
| ---- | ---------------- |
| -d   | 解压到指定目录   |
| -n   | 不覆盖原来的文件 |
| -v   | 查看压缩包内容   |

### gzip

> Linux中常用的压缩解压命令，推荐的压缩格式

| 选项 | 含义                    |
| ---- | ----------------------- |
| -d   | 解压                    |
| -n   | 指定压缩级别，范围是1-9 |

### bzip2/bunzip2

> 一对压缩和解压命令
>
> 注意：在利用bzip2进行文件的压缩后，压缩前的原始文件消失，系统会生成一个新的压缩文件，文件名的后缀为.bz2。另外，利用bzip2压缩后的压缩文件必须利用bunzip2命令才能实现解压，恢复为原始文件。

### zcat/bzcat

> 查看压缩文件内容
>
> 不同：
>
> - zcat针对.gz后缀的压缩文件进行查看。
> - bzcat针对.bz2后缀的压缩文件进行查看。

### 总结

1. `*.tar`用tar -xvf解压
2. `*.gz`用gzip -d或者gunzip解压
3. `*.tar.gz`和`*.tgz`用tar -xzf解压
4. `*.bz2`用bzip2 -d或者用bunzip2解压
5. `*.tar.bz2`用tar -xjf解压
6. `*.Z`用uncompress解压
7. `*.tar.Z`用tar -xZf解压
8. `*.rar`用unrar e解压
9. `*.zip`用unzip解压

## 4.6 磁盘操作命令

磁盘分区

- Windows、Linu×下有主分区、扩展分区和逻辑分区的

概念：

- 主分区
  - 一个磁盘的主分区至少1个，最多3．4个
- 扩展分区
  - 扩展分区的数量为0一1个，扩展分区不能直接使用，需要划分逻辑分区后才能使用
- 逻辑分区
  - 必须基于扩展分区创建，数量没有限制

注意：主分区+扩展分区<=4

linux的分区及编号

sda1

sd：SATA或者SCSI类型的硬盘

a：硬盘名称，a表示第一块硬盘，以此类推

1：分区编号，1表示第一个分区，以此类推

| 命令   | 英文              | 描述                                        |
| ------ | ----------------- | ------------------------------------------- |
| mount  | mount             | 用于将文件系统挂载到Linux文件树中的指定位置 |
| umount | unmount           | 用于卸载已经挂载的文件系统                  |
| df     | disk free         | 用于显示磁盘空间使用情况                    |
| du     | disk usage        | 用于显示目录或文件所占用的磁盘空间大小      |
| fsck   | file system check | 用于在启动时检查和修复文件系统错误          |

### mount

> 挂载设备（硬盘分区，光盘，U盘，移动硬盘等）到系统
>
> 注意：需要先创建挂载点才能挂载

命令格式：

mount [-t 文件系统] [-o 选项] 设备 挂载点（目录）

| 选项 | 含义               |
| ---- | ------------------ |
| -t   | 指定文件系统的类型 |
| -o   | 描述设备挂载方式   |
| -a   | 挂载所有设备       |

### unmount

> 卸载已经挂载的文件系统

### df

| 选项 | 含义                                               |
| ---- | -------------------------------------------------- |
| -a   | 包含全部的文件系统                                 |
| -h   | 把各分区的大小和挂载的分区的大小以MB或GB的单位显示 |
| -T   | 显示文件系统的类型                                 |

### fsck

> 硬盘检测，注意：该命令只能root用户执行

## 4.7 关机重启命令

| 命令     | 英文           | 描述                                         |
| -------- | -------------- | -------------------------------------------- |
| shutdown | shutdown       | 用于安全地关闭系统并提供定时或立即关闭的选项 |
| halt     | halt           | 用于关闭系统并停止所有进程                   |
| poweroff | power off      | 用于关闭系统并断电(直接使用)                 |
| reboot   | reboot         | 用于重新启动系统(直接使用)                   |
| init     | initialization | 用于切换系统运行级别和启动或停止指定服务     |

### shutdown 

> shutdown 命令可以安全关闭或者重新启动系统
>
> 注意：root用户，才可用此命令

| 选项 | 含义                     |
| ---- | ------------------------ |
| -r   | 系统服务停掉然后安全重启 |
| -h   | 系统服务停掉然后安全关机 |

1. 不指定选项和参数，默认表示 1 分钟之后关闭电脑
2. 远程维护服务器时，最好不要关闭系统，而应该重新启动系统

常用命令示例

```bash
#重新启动操作系统，其中now表示现在
$ shutdown -r now
#立刻关机，其中now表示现在
shutdon now
#系统在今天的20:25会关机
$ shutdon 20:25
#系统再过十分钟后自动关机
$ shutdown +1
#取消之前指定的关机计划
$shutdown -C
```

### hait

> 小知识：hait = shutdown -h
>
> hait -h 强行关机

### init

> 切换Ubuntu的运行级别
>
> 说明：init命令中的“运行级别”一共有7级，    分别是从0-6。

| 运行级别 | 描述                                          |
| -------- | --------------------------------------------- |
| 0        | 停机或者关机（干万不能将initdefaulti设置为0） |
| 1        | 单用户模式，只root用户进行维护                |
| 2        | 多用户模式，不能使用NFS(Net File System)      |
| 3        | 完全多用户模式（标准的运行级别）              |
| 4        | 安全模式                                      |
| 5        | 图形化（即图形界面）                          |
| 6        | 重启（干万不要把initdefault设置为6）          |

## 4.8 其它常用命令

| 命令    | 英文     | 描述                                        |
| ------- | -------- | ------------------------------------------- |
| more    | more     | 用于显示文件内容，一页一页地显示            |
| less    | less     | 用于显示文件内容，可以向前或向后翻页        |
| help    | help     | 用于显示bash shell内置命令的帮助信息        |
| man     | manual   | 用于显示Linux系统中安装的大部分命令的手册页 |
| cal     | calendar | 用于显示日历                                |
| date    | date     | 用于显示或设置系统的日期和时间              |
| file    | file     | 查看文件属性                                |
| history | history  | 查看执行过的命令                            |
| ln      | link     | 软硬链接                                    |

### more/less

- `more` 命令可以用于分屏显示文件内容，每次只显示一页内容
- 简单地浏览一个较小的文本文件，并且只需要向下滚动，可以使用 `more` 命令
- `less` 命令则支持向上和向下滚动文本
- 需要查看较大的文本文件，并且需要进行更多的交互和操作，建议使用 `less` 命令

| 操作键   | 功能                 |
| -------- | -------------------- |
| 空格键   | 显示手册页的下一屏   |
| Enter 键 | 一次滚动手册页的一行 |
| b        | 回滚一屏             |
| f        | 前滚一屏             |
| q        | 退出                 |
| /word    | 搜索 word 字符串     |

### help/man

`-help`

```bash
	command --help
	显示command命令的帮助信息
```

`man`

```bash
	man command
	查阅command命令的使用手册
```

> man 是 manual 的缩写，是 Linux 提供的一个手册，包含绝大部分命令、函数的详细使用说明

使用 man 时的操作键：

| 操作键   | 功能                 |
| -------- | -------------------- |
| 空格键   | 显示手册页的下一屏   |
| Enter 键 | 一次滚动手册页的一行 |
| b        | 回滚一屏             |
| f        | 前滚一屏             |
| q        | 退出                 |
| /word    | 搜索 word 字符串     |

### cal/date

`cal`显示日历

命令格式：cal [选项 [月份[年份]]]

| 选项 | 含义                                   |
| ---- | -------------------------------------- |
| -m   | 显示1-12月日历                         |
| -j   | 以凯撒历显示，即以一月一日起的天数显示 |
| -y   | 显示今年年历                           |

`date`显示及修改系统的日期和时间

> 注意：要修改系统时间，要取得root权限。

### ln

| 命令                       | 作用             |
| -------------------------- | ---------------- |
| In 被链接的源文件 链接文件 | 建立文件的软链接 |

注意：

- 有`s`选项建立的是一个**软链接文件**
- **源文件要使用绝对路径**，不能使用相对路径，这样可以方便移动链接文件后，仍然能够正常使用

**软/硬链接简介（了解）**

- 软链接类似于 Windows 下的快捷方式

- 在使用`ln`创建链接时，如果没有`s`选项，会创建一个硬链接，而不是软链接
- 两个文件占用相同大小的硬盘空间，工作中几乎不会建立文件的硬链接

**文件软硬链接的示意图**

> 在 Linux 中，文件名和文件的数据是分开存储的

![https://tvax2.sinaimg.cn/large/005SZA4oly1h19esqt7foj30ln07fgmk.jpg](https://tvax2.sinaimg.cn/large/005SZA4oly1h19esqt7foj30ln07fgmk.jpg)

提示：

- 在`Linux`中，只有文件的`硬链接数 == 0`才会被删除
- 使用`ls-l`可以查看一个文件的硬链接的数量
- 在日常工作中，几乎不会建立文件的硬链接

### $(普通用户)与#(超级用户)之间的切换

- 默认登录的是普通用户权限，显示$符

- 超级用户权限，显示#符

- 从普通用户切换超级用户权限：sudo su

- 从超级用户切换普通用户：su 用户名。
